0001_initial.py
@@ -0,0 +1,44 @@
# Generated by Django 4.2 on 2023-05-03 08:28

from django.db import migrations, models
import django.db.models.deletion
import myapp.models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Catagory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=150)),
                ('image', models.ImageField(blank=True, null=True, upload_to=myapp.models.getFileName)),
                ('description', models.TextField(max_length=500)),
                ('status', models.BooleanField(default=False, help_text='0-show,1-Hidden')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='Product',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=150)),
                ('vendor', models.CharField(max_length=150)),
                ('product_image', models.ImageField(blank=True, null=True, upload_to=myapp.models.getFileName)),
                ('quantity', models.IntegerField()),
                ('original_price', models.IntegerField()),
                ('selling_price', models.IntegerField()),
                ('description', models.TextField(max_length=500)),
                ('status', models.BooleanField(default=False, help_text='0-show,1-Hidden')),
                ('trending', models.BooleanField(default=False, help_text='0-default,1-Trending')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='myapp.catagory')),
            ],
        ),
    ]
 26 changes: 26 additions & 0 deletions26  
0002_cart.py
@@ -0,0 +1,26 @@
# Generated by Django 4.2 on 2023-05-07 16:59

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('myapp', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='Cart',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('product_qty', models.IntegerField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='myapp.product')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]
 25 changes: 25 additions & 0 deletions25  
0003_favourite.py
@@ -0,0 +1,25 @@
# Generated by Django 4.2 on 2023-05-09 16:54

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('myapp', '0002_cart'),
    ]

    operations = [
        migrations.CreateModel(
            name='Favourite',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='myapp.product')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
    ]
 50 changes: 50 additions & 0 deletions50  
0004_order_orderitem.py
@@ -0,0 +1,50 @@
# Generated by Django 4.2 on 2023-07-10 05:35

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('myapp', '0003_favourite'),
    ]

    operations = [
        migrations.CreateModel(
            name='Order',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('fname', models.CharField(max_length=150)),
                ('lname', models.CharField(max_length=150)),
                ('email', models.CharField(max_length=150)),
                ('phone', models.CharField(max_length=150)),
                ('address', models.CharField(max_length=150)),
                ('city', models.CharField(max_length=150)),
                ('state', models.CharField(max_length=150)),
                ('country', models.CharField(max_length=150)),
                ('pincode', models.CharField(max_length=150)),
                ('total_price', models.FloatField()),
                ('payment_mode', models.CharField(max_length=150)),
                ('payment_id', models.CharField(max_length=150, null=True)),
                ('status', models.CharField(choices=[('Pending', 'Pending'), ('Out for Shipping', 'Out for Shipping'), ('Completed', 'Completed')], default='Pending', max_length=150)),
                ('message', models.TextField(null=True)),
                ('tracking_no', models.CharField(max_length=150, null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.CreateModel(
            name='OrderItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('price', models.FloatField()),
                ('quantity', models.IntegerField()),
                ('order', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='myapp.order')),
                ('product', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='myapp.product')),
            ],
        ),
    ]
 Empty file added0  
__init__.py
Empty file.
 30 changes: 30 additions & 0 deletions30  
addcart.py
@@ -0,0 +1,30 @@
from django.http import JsonResponse
from django.shortcuts import render,redirect
from .models import *
from django.contrib import messages
from myapp.form import CustomUserForm
from django.contrib.auth import authenticate,login,logout
import json
from django.contrib.auth.decorators import login_required


def add_to_cart(request):
   if request.headers.get('x-requested-with')=='XMLHttpRequest':
    if request.user.is_authenticated:
      data=json.load(request)
      product_qty=data['product_qty']
      product_id=data['pid']
      product_status=Product.objects.get(id=product_id)
      if product_status:
        if Cart.objects.filter(user=request.user.id,product_id=product_id):
          return JsonResponse({'status':'Product Already in Cart'}, status=200)
        else:
          if product_status.quantity>=product_qty:
            Cart.objects.create(user=request.user,product_id=product_id,product_qty=product_qty)
            return JsonResponse({'status':'Product Added to Cart'}, status=200)
          else:
            return JsonResponse({'status':'Product Stock Not Available'}, status=200)
    else:
      return JsonResponse({'status':'Login to Add Cart'}, status=200)
   else:
     return JsonResponse({'status':'Invalid Access'}, status=200)
 13 changes: 13 additions & 0 deletions13  
admin.py
@@ -0,0 +1,13 @@
from atexit import register
from django.contrib import admin
from .models import *
# Register your models here.

# class CateoryAdmin(admin.ModelAdmin):
#     list_display=('name','image','description')
# admin.site.register(Catagory,CateoryAdmin)


admin.site.register(Catagory)
admin.site.register(Product)
admin.site.register(Cart)
 6 changes: 6 additions & 0 deletions6  
apps.py
@@ -0,0 +1,6 @@
from django.apps import AppConfig


class MyappConfig(AppConfig):
    default_auto_field = 'django.db.models.BigAutoField'
    name = 'myapp'
 16 changes: 16 additions & 0 deletions16  
asgi.py
@@ -0,0 +1,16 @@
"""
ASGI config for logi project.
It exposes the ASGI callable as a module-level variable named ``application``.
For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/asgi/
"""

import os

from django.core.asgi import get_asgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'logi.settings')

application = get_asgi_application()
 63 changes: 63 additions & 0 deletions63  
cart.html
@@ -0,0 +1,63 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> E-Mart | Online shoping</title>
{% endblock title %}
{% block content %}
<section class="bg-light py-3 my-5" style="min-height: 600px;">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4 class="mb-3">Cart Items</h4>
                <hr style="border-color: #b8bfc2;">
            </div>

    <table class="">
        <tr>
            <th>Image</th>
            <th>Product Name</th>
            <th>Unit</th>
            <th>Quantity</th>
            <th>Amount</th>
            <th>Remove</th>
        </tr> 
        {% for item in cart %}

        <tr>
            <td><img src="{{item.product.product_image.url}}" height="75px" alt="{{item.product.name}}"></td>
            <td>{{item.product.name}}</td>
            <td>{{item.product.selling_price | stringformat:'d'}}</td>
            <td>{{item.product_qty}}</td>
            <td class="amt">{{item.total_cost | stringformat:'d'}}</td>
            <td><a href="{% url 'remove_cart' item.id %}" onclick="return confirm('Are you sure? to Remove')" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i>Remove</a></td>
        </tr>
        {% endfor %}

        <tr>
            <td></td>
            <td></td>
            <td colspan="2"><b>Total Amount</b></td>
            <th id="net">0</th>
            <td><a href="{% url 'checkout' %}" class="btn btn-primary btn-sm">
              <i class="fa fa-check-circle"></i> Check Out
            </a></td>
          </tr>

     </table>

        </div>
    </div>

</section>
<script>
    const nodes = document.querySelectorAll('.amt');
    const arr = Array.from(nodes);
    const res = arr.reduce((acc, curr) => {
        return acc += Number(curr.textContent)
    }, 0);
    document.getElementById("net").innerHTML="Rs : "+res;



</script>

{% endblock content %}
 129 changes: 129 additions & 0 deletions129  
checkout.html
@@ -0,0 +1,129 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> E-Mart | Online shoping</title>
{% endblock title %}
{% block content %}
<section class="bg-light py-4 my-5" style="min-height:600px;">
    <div class="container">
      <div class="row">
        <div class="col-12">
          <h4 class="mb-3">{{category_name}} Products</h4>
          <hr style="border-color:#b8bfc2;">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                      <li class="breadcrumb-item active">checkout</li>
                    </ol>
                  </nav>
                  {% include 'shop/inc/message.html' %}
            </div>


    </div>
    <div class="container mt-3">
        <form action="{% url 'placeorder' %}" method="POST">
            {% csrf_token %}
            <div class="row">
            <div class="col-md-7">
                <div class="card shadow checkoutform">
                    <div class="card-body">
                        <h6>Basic Details</h6>
                        <hr>
                        <div class="row">
                            <div class="col-md-6">
                                <label>First Name</label><br>
                                <input type="text"class="col-md-12" required name="fname" placeholder="Enter first name">
                            </div>
                            <div class="col-md-6">
                                <label>Last Name</label><br>
                                <input required type="text"class="col-md-12" name="lname" placeholder="Enter lirst name">
                            </div>
                            <div class="col-md-6">
                                <label>Email</label><br>
                                <input required type="email"class="col-md-12"name="email" placeholder="Enter Email">
                            </div>
                            <div class="col-md-6">
                                <label>Phone</label><br>
                                <input required type="tel"class="col-md-12"name="phone" placeholder="Enter Phone">
                            </div>
                            <div class="col-md-12">
                                <label>Address</label><br>
                                <textarea required class="col-md-12" type="text"name="address" placeholder="Enter first name"></textarea>
                            </div>
                            <div class="col-md-6">
                                <label>City</label><br>
                                <input required type="text"class="col-md-12"name="city" placeholder="Enter City">
                            </div><div class="col-md-6">
                                <label>State</label><br>
                                <input required type="text" class="col-md-12"name="state" placeholder="Enter State">
                            </div>
                            <div class="col-md-6">
                                <label>Country</label><br>
                                <input required type="text"class="col-md-12"name="country" placeholder="Enter Country">
                            </div>
                            <div class="col-md-6">
                                <label>Pin Code</label><br>
                                <input required type="text"class="col-md-12"name="pincode" placeholder="Enter Pin Code">
                            </div>
                        </div>
                    </div>
                </div>
                </div>
                <div class="col-md-5">
                    <div class="card shadow">
                        <div class="card-body">
                            <h6>Order Summary</h6>
                            <hr>
                            {% if cartitems %}
                            <table class="table table-stripeds table-bordereds">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Qty</th>
                                        <th>Price</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for item in cartitems %}
                                    <tr>
                                        <td>
                                        <img src="{{ item.product.product_image.url }}" height="50px" width="50px" class="me-2">
                                        {{item.product.name}}</td>
                                        <td>{{item.product_qty}}</td>
                                        <!-- <td>{{item.product.selling_price}}</td> -->
                                        <td class="amt">{{item.total_cost | stringformat:'d'}}</td>

                                    </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                            <h6 class="fw-bold">
                                Grand Total
                                <span class="float-end"> Rs {{ total_price }}</span>
                            </h6>
                            <input type="hidden" value="COD" name="payment_mode">
                            <div class="mt-3">
                                <button type="submit" class="btn btn-success w-100">COD | Place Order</button>
                                <button type="button" class="btn btn-primary payWithRazorpay w-100 mt-2">Pay with Razorpay</button>



                            </div>
                            {% else %}
                        <h4> Your Crt is Empty</h4>
                            {% endif%}
                        </div>
                    </div>
                </div>
                </div>
        </form>
            </div>


</section>

{% endblock content %}

{% block scripts %}
<script src="https://checkout.razorpay.com/v1/checkout.js"></script>
{% endblock scripts %}
 70 changes: 70 additions & 0 deletions70  
checkout.js
@@ -0,0 +1,70 @@
(function($){


$(document).ready(function (){

    $('.payWithRazorpay').click(function(e){
        e.preventDefault();

        var fname = $("[name='fname']").val();
        var lname = $("[name='lname']").val();
        var email = $("[name='email']").val();
        var phone = $("[name='phone']").val();
        var address = $("[name='address']").val();
        var city = $("[name='city']").val();
        var state = $("[name='state']").val();
        var country = $("[name='country']").val();
        var pincode = $("[name='pincode']").val();

        if(fname =="" || lname=="" || email =="" || phone =="" || address =="" || city=="" || state =="" || country =="" || pincode =="") 
        {
            alert("All fields are mandatory");
            return false;
        }       
        else
        {
            $.ajax({
                method: "GET",
                url: "proceed-to-pay",

                success: function(response){
                    console.log(response);

                }
            });
            var options = {
                "key": "YOUR_KEY_ID", // Enter the Key ID generated from the Dashboard
                "amount": "50000", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
                "currency": "INR",
                "name": "Acme Corp", //your business name
                "description": "Test Transaction",
                "image": "https://example.com/your_logo",
                "order_id": "order_9A33XWu170gUtm", //This is a sample Order ID. Pass the `id` obtained in the response of Step 1
                "handler": function (response){
                    alert(response.razorpay_payment_id);
                    alert(response.razorpay_order_id);
                    alert(response.razorpay_signature)
                },
                "prefill": { //We recommend using the prefill parameter to auto-fill customer's contact information, especially their phone number
                    "name": "Gaurav Kumar", //your customer's name
                    "email": "gaurav.kumar@example.com", 
                    "contact": "9000090000"  //Provide the customer's phone number for better conversion rates 
                },
                "notes": {
                    "address": "Razorpay Corporate Office"
                },
                "theme": {
                    "color": "#3399cc"
                }
            };
            var rzp1 = new Razorpay(options);
            rzp1.open();

        }



    });
});

});
 50 changes: 50 additions & 0 deletions50  
collections.html
@@ -0,0 +1,50 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> Registration | EMart</title>
{% endblock title %}
{% block content %}


<section class="py-5 text-center container" style="margin-top: 70px;">
    <div class="row py-lg-5">
        <div class="col-lg-6 col-md-8 mx-auto">
            <h1 class="fw-light">Bestsellers</h1>
            <p class="lead text-muted">Our most popular products based on sales. Updated hourly</p>
            <p>
                <a href="" class="btn btn-primary my-2">Already User</a>
                <a href="" class="btn btn-secondary my-2">Register</a>
            </p>
        </div>
    </div>

</section>
<section class="bg-light py-4 my-5">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4 class="mb-3">Categories</h4>
                <hr style="border-color: #b8bfc2;">
    {% include 'shop/inc/message.html' %}

            </div>
            {% for item in catagory %}
        <div class="col-md-4 col-lg-3">
          <div class="card my-3">
            <img src="{{item.image.url}}" width="260px" height="200px" class="card-image-top" alt="Categories">
            <a href="{% url 'collections' item.name %}">
            <div class="card-body">
              <h5 class="card-title text-primary">{{ item.name }}</h5>
              <p class="card-text">{{ item.description }}</p>

            </div>
          </a>
          </div>
        </div>
        {% endfor %}
        </div>
    </div>

</section>


{% endblock content %}
 35 changes: 35 additions & 0 deletions35  
fav.html
@@ -0,0 +1,35 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> E-Mart | Online shoping</title>
{% endblock title %}
{% block content %}

<section class="bg-light py-3 my-5" style="min-height: 600px;">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4 class="mb-3">Favourite Items</h4>
                <hr style="border-color: #b8bfc2;">
            </div>

    <table class="">
        <tr>
            <th>Image</th>
            <th>Product Name</th>
            <th>Unit</th>
            <th>Remove</th>
        </tr> 
        {% for item in fav %}

        <tr>
            <td><img src="{{item.product.product_image.url}}" height="75px" alt="{{item.product.name}}"></td>
            <td>{{item.product.name}}</td>
            <td>{{item.product.selling_price | stringformat:'d'}}</td>
            <td><a href="{% url 'remove_fav' item.id %}" onclick="return confirm('Are you sure? to Remove')" class="btn btn-danger btn-sm"><i class="fa fa-trash"></i>Remove</a></td>
        </tr>
        {% endfor %}
        </table>

</section>

{% endblock content %}
 55 changes: 55 additions & 0 deletions55  
footer.html
@@ -0,0 +1,55 @@
<footer class="text-center text-lg-start bg-dark text-white">
    <section class="container d-flex justify-content-center justify-content-lg-between p-4">
      <div class="me-5 d-none d-lg-block">
        <span>Get connected with us on social networks:</span>
      </div>
      <div style="text-decoration: none;">
        <a href="" class="me-4 text-reset"><i class="fa fa-facebook"></i></a>
        <a href="" class="me-4 text-reset"><i class="fa fa-twitter"></i></a>
        <a href="" class="me-4 text-reset"><i class="fa fa-google"></i></a>
        <a href="" class="me-4 text-reset"><i class="fa fa-instagram"></i></a>
        <a href="" class="me-4 text-reset"><i class="fa fa-linkedin"></i></a>
        <a href="" class="me-4 text-reset"><i class="fa fa-github"></i></a>
      </div>
    </section>

    <section class="">
      <div class="container text-center text-md-start mt-5">
        <div class="row mt-3">
          <div class="col-md-3 col-lg-4 col-xl-3 mx-auto mb-4">
            <h6 class="text-uppercase fw-bold mb-4"><i class="fa fa-cart-plus"></i> E-Mart</h6>
            <p>
                E-Mart.com is a one stop destination for your family's fashion needs.
               We give you the opportunity to give your wardrobe a makeover with the latest collections from our top brands.
            </p>
          </div>

          <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mb-4" style="text-decoration: none;">
            <h6 class="text-uppercase fw-bold mb-4">Make Money with Us</h6>
            <p><a href="#!"style="text-decoration: none;" class="text-reset">Sell on E-Mart</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">Advertise Your Products</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">Become an Affiliate</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">Fulfilment by E-Mart</a></p>
          </div>
          <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mb-4">
            <h6 class="text-uppercase fw-bold mb-4">Useful links</h6>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">FAQ</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">Feedback</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">About Us</a></p>
            <p><a href="#!" style="text-decoration: none;" class="text-reset">Contact Us</a></p>
          </div>

          <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mb-md-0 mb-4">
            <h6 class="text-uppercase fw-bold mb-4"> Contact</h6>
            <p><i class="fa fa-home"></i> Logeshwari</p>
            <p><i class="fa fa-envelope"></i> logi.bcs@gmail.com</p>
            <p><i class="fa fa-phone"></i> + 91 8015517365</p>
          </div>

        </div>
      </div>
    </section>
    <div class="text-center p-4">
      &copy;  2021 Copyright <a class="text-reset fw-bold" style="text-decoration: none;" href="logeshwarisathya"> Logeshwari.in</a>
    </div>
  </footer>
 18 changes: 18 additions & 0 deletions18  
form.py
@@ -0,0 +1,18 @@
from pyexpat import model
from django.contrib.auth.forms import UserCreationForm
from .models import User
from django import forms

class CustomUserForm(UserCreationForm):
    username=forms.CharField(widget=forms.TextInput(attrs={'class':'form-control','placeholder':'Enter User Name'}))
    email=forms.CharField(widget=forms.TextInput(attrs={'class':'form-control','placeholder':'Enter Email Address'}))
    password1=forms.CharField(widget=forms.PasswordInput(attrs={'class':'form-control','placeholder':'Enter Password'}))
    password2=forms.CharField(widget=forms.PasswordInput(attrs={'class':'form-control','placeholder':'Enter Confirm Password'}))

    class Meta:
        model=User
        fields=['username','email','password1','password2']




 47 changes: 47 additions & 0 deletions47  
index.html
@@ -0,0 +1,47 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> E-Mart | Online shoping</title>
{% endblock title %}



{% block content %}
<section class="bg-light py-4 my-5">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4 class="mb-3">{{category_name}} Products</h4>
                <hr style="border-color: #b8bfc2;">
                <nav aria-label="breadcrumb">
                  <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                    <li class="breadcrumb-item active">{{category_name}} Collections</li>
                  </ol>
                </nav>
                {% include 'shop/inc/message.html' %}
            </div>
            {% for item in products %}
            <div class="col-md-4 col-lg-3" >
              <div class="card my-3">
                <img src="{{item.product_image.url}}" width="250px" height="300px" class="card-image-top" alt="Categories">
                <hr style="border-color: #b8bfc2;">

                <a href="{% url 'product_details' category_name item.name %}">
                <div class="card-body">
                  <h5 class="card-title text-primary">{{ item.name }}</h5>
                  <p class="card-text">
                    <span class="float-start old_price"><s>Rs.{{ item.original_price | stringformat:'d'}}</s></span>
                    <span class="float-end new_price">Rs.{{ item.selling_price | stringformat:'d' }}</span>
                  </p>
                </div>
              </a>
              </div>
            </div>
            {% endfor %}
        </div>
    </div>

</section>


{% endblock content %}
 39 changes: 39 additions & 0 deletions39  
login.html
@@ -0,0 +1,39 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> Registration | EMart</title>
{% endblock title %}
{% block content %}

<div class="container" style="margin-top: 70px;">
    <div class="row">
        <div class="col-12">
        <h4 class="mb-3">User Login</h4>
        <hr style="border-color: #b8bfc2;">
    {% include 'shop/inc/message.html' %}

    </div>
    </div>
    <section class="py-4 my-5">
        <div class="container">
            <div class="row">
                <div class="col-6">
                    <form method="post" action="">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label for="" class="form-label">User Name</label>
                            <input type="text" name="username" id="username" class="form-control" placeholder="Enter User Name">
                         </div>
                        <div class="mb-4">
                            <label for="" class="form-label">User Email</label>
                            <input type="password" name="password" id="password" class="form-control" placeholder="Enter Password">

                        </div>
                        <button type="submit" class="btn btn-primary">Login</button>
                   </form>
                </div>
            </div>
        </div>

    </section>
</div>
{% endblock content %}
 62 changes: 62 additions & 0 deletions62  
main.html
@@ -0,0 +1,62 @@
{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    {% block title %}
    {% endblock title %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="{% static 'css/style.css' %}">
  </head>
  <style>
    a{
    text-decoration: none;
    }
    a:link {
      text-decoration: none;
      color: black;
    }

    a:visited {
      text-decoration: none;
      color: black;

    }

    a:hover {
      text-decoration: none;
      color: black;

    }

    a:active {
      text-decoration: none;
      color: black;

    }

  </style>
  <body>
    {% include 'shop/inc/navbar.html' %}
    {% block content %}
    {% endblock content %}

    {% block scripts %}
    {% endblock scripts %}
    {% include 'shop/inc/footer.html' %}







   <script src="{% static '/js/checkout.js' %}"></script>    
  </body>
</html>
 22 changes: 22 additions & 0 deletions22  
manage.py
@@ -0,0 +1,22 @@
#!/usr/bin/env python
"""Django's command-line utility for administrative tasks."""
import os
import sys


def main():
    """Run administrative tasks."""
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'logi.settings')
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            "Couldn't import Django. Are you sure it's installed and "
            "available on your PYTHONPATH environment variable? Did you "
            "forget to activate a virtual environment?"
        ) from exc
    execute_from_command_line(sys.argv)


if __name__ == '__main__':
    main()
 6 changes: 6 additions & 0 deletions6  
message.html
@@ -0,0 +1,6 @@
{% for msg in messages %}
<div class="alert alert-info alert-dismissible fade show" role="alert">
    {{msg}}
<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="close"></button>
</div>
{% endfor %}
 95 changes: 95 additions & 0 deletions95  
models.py
@@ -0,0 +1,95 @@


from itertools import product
from django.db import models
from django.contrib.auth.models import User
import datetime
import os

def getFileName(request,filename):
    now_time=datetime.datetime.now().strftime("%Y%m%d%H:5M:%S")
    new_filename="%s%s"%(now_time,filename)
    return os.path.join('uploads/',new_filename)

class Catagory(models.Model):
    name=models.CharField(max_length=150,null=False,blank=False)
    image=models.ImageField(upload_to=getFileName,null=True, blank=True)
    description=models.TextField(max_length=500,null=False,blank=False)
    status=models.BooleanField(default=False,help_text="0-show,1-Hidden")
    created_at=models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.name

class Product(models.Model):
    category=models.ForeignKey(Catagory,on_delete=models.CASCADE)
    name=models.CharField(max_length=150,null=False,blank=False)
    vendor=models.CharField(max_length=150,null=False,blank=False)
    product_image=models.ImageField(upload_to=getFileName,null=True, blank=True)
    quantity=models.IntegerField(null=False,blank=False)
    original_price=models.IntegerField(null=False,blank=False)
    selling_price=models.IntegerField(null=False,blank=False)
    description=models.TextField(max_length=500,null=False,blank=False)
    status=models.BooleanField(default=False,help_text="0-show,1-Hidden")
    trending=models.BooleanField(default=False,help_text="0-default,1-Trending")
    created_at=models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return self.name


class Cart(models.Model):
  user=models.ForeignKey(User,on_delete=models.CASCADE)
  product=models.ForeignKey(Product,on_delete=models.CASCADE)
  product_qty=models.IntegerField(null=False,blank=False)
  created_at=models.DateTimeField(auto_now_add=True)

  @property
  def total_cost(self):
      return self.product_qty*self.product.selling_price


class Favourite(models.Model):
    user=models.ForeignKey(User,on_delete=models.CASCADE)
    product=models.ForeignKey(Product,on_delete=models.CASCADE)
    created_at=models.DateTimeField(auto_now_add=True)



class Order(models.Model):
    user=models.ForeignKey(User,on_delete=models.CASCADE)
    fname=models.CharField(max_length=150, null=False)
    lname=models.CharField(max_length=150, null=False)
    email=models.CharField(max_length=150, null=False)
    phone=models.CharField(max_length=150, null=False)
    address=models.CharField(max_length=150, null=False)
    city=models.CharField(max_length=150, null=False)
    state=models.CharField(max_length=150, null=False)
    country=models.CharField(max_length=150, null=False)
    pincode=models.CharField(max_length=150, null=False)
    total_price=models.FloatField(null=False)
    payment_mode=models.CharField(max_length=150,null=False)
    payment_id=models.CharField(max_length=150,null=True)
    orderstatuses=(
        ('Pending','Pending'),
        ('Out for Shipping','Out for Shipping'),
        ('Completed','Completed'),
    )
    status=models.CharField(max_length=150,choices=orderstatuses,default='Pending')
    message=models.TextField(null=True)
    tracking_no=models.CharField(max_length=150,null=True)
    created_at=models.DateTimeField(auto_now_add=True)
    updated_at=models.DateTimeField(auto_now=True)

    def __str__(self):
        return '{}-{}'.format(self.id,self.tracking_no)


class OrderItem(models.Model):
    order=models.ForeignKey(Order,on_delete=models.CASCADE)
    product=models.ForeignKey(Product,on_delete=models.CASCADE)
    price=models.FloatField(null=False)
    quantity=models.IntegerField(null=False)

    def __str__(self):
        return '{} {}'.format(self.order.id,self.order.tracking_no)
 23 changes: 23 additions & 0 deletions23  
navbar.html
@@ -0,0 +1,23 @@
<nav class="navbar navbar-expand-lg  navbar-dark bg-dark fixed-top">
  <div class="container">
    <a class="navbar-brand" href="{% url 'home' %}"><i class="fa fa-cart-plus"></i> ShopKart</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
      <div class="navbar-nav ms-auto">
        <a class="nav-link" aria-current="page" href="{% url 'home' %}"><i class="fa fa-home"></i> Home</a>
        {% if request.user.is_authenticated %}
          <a class="nav-link" aria-current="page" href="#"><i class="fa fa-user"></i> {{request.user}}</a>
          <a class="nav-link" aria-current="page" href="{% url 'signout' %}"><i class="fa fa-sign-out"></i> Logout</a>
        {% else %}
          <a class="nav-link" href="{% url 'login' %}"><i class="fa fa-sign-in"></i> Login</a>
          <a class="nav-link" href="{% url 'register' %}"><i class="fa fa-users"></i> Register</a>
        {% endif %}
          <a class="nav-link" href="{% url 'collections' %}"><i class="fa fa-cubes"></i> Collections</a>
          <a class="nav-link" href="{% url 'cart' %}"><i class="fa fa-shopping-cart"></i> Cart</a>
          <a class="nav-link" href="{% url 'favviewpage' %}"><i class="fa fa-heart"></i> Favourite</a>
      </div>
    </div>
  </div>
</nav>
 156 changes: 156 additions & 0 deletions156  
product_details.html
@@ -0,0 +1,156 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> E-Mart | Online shoping</title>
{% endblock title %}



{% block content %}
<section class="bg-light py-4 my-5" >
    <div class="container">
        <div class="row">
            <div class="col-12">
                <h4 class="mb-3"> {{products}} Details</h4>
                <hr style="border-color: #b8bfc2;">
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                      <li class="breadcrumb-item"><a href="{% url 'home' %}">Home</a></li>
                      <li class="breadcrumb-item"><a href="{% url 'collections' products.category.name %}">Collections</a></li>
                      <li class="breadcrumb-item active" aria-current="page">{{products}}</li>
                    </ol>
                  </nav>
                {% include 'shop/inc/message.html' %}

            </div>
            <div class="col-5 my-3 pic-box">
            {% if products.trending %}

              <div class="hot">Hot</div>
            {% endif %}

            <img src="{{products.product_image.url}}" width="270px" height="320px" class="card-image-top" alt="{{products}}">
        </div>
        <div class="col-7 my-4">
          <h5 class="text-success">{{products | upper}}</h5>
          <p>{{products.vendor}}</p>
          <p>{{products.description}}</p>
          <h6 class="my-2 text-danger">Current Price : Rs.<s>{{products.original_price}}</s></h6>
          <h5 class="my-2 text-primary">Offer Price   : Rs.{{products.selling_price}}</h5>
          <div class="my-3">
            {% if products.quantity > 0 %}
            <input type="hidden" value="{{products.id}}" id="pid">

            <p>
              <div class="input-group" style="width: 150px;">
                <button class="input-group-text bg-success text-light" id="btnMinus" ><i class="fa fa-minus"></i></button>
                    <input type="text" name="qty" id="txtQty" value="1" class="form-control text-center">
                  <button class="input-group-text bg-success text-light" id="btnPlus"><i class="fa fa-plus"></i></button>

              </div>
            </p>
            <button class="btn btn-primary" id="btnCart"><i class="fa fa-shopping-cart"></i>Add to Cart</button>
            {% else %}
            <button class="btn btn-secondary"><i class="fa fa-minus"></i>Out of Stock</button>
            {% endif %}
            <button class="btn btn-danger" id="btnFav"><i class="fa fa-heart"></i></button>
          </div>
        </div>
        </div>
    </div>

</section>
<script>
  document.addEventListener("DOMContentLoaded",function(event){
    const btnPlus = document.getElementById("btnPlus");
    const btnMinus = document.getElementById("btnMinus");
    const txtQty = document.getElementById("txtQty");
    const pid = document.getElementById("pid");
    const btnCart = document.getElementById("btnCart");
    const btnFav = document.getElementById("btnFav");


  btnPlus.addEventListener("click", function() {
    let qty=parseInt(txtQty.value,10);
    qty=isNaN(qty)?0:qty;
    //console.log(qty);
    if(qty<10){
      qty++;
      txtQty.value=qty;
    }
 });
 btnMinus.addEventListener("click", function() {
      let qty=parseInt(txtQty.value,10);
      qty=isNaN(qty)?0:qty;
      //console.log(qty);
      if(qty>1){
        qty--;
        txtQty.value=qty;
      }
    }); 

    btnCart.addEventListener("click", function() {
      let qty=parseInt(txtQty.value,10);
      qty=isNaN(qty)?0:qty;

      if(qty>0){
        let postObj = { 
            'product_qty': qty, 
            'pid': pid.value
        }
        //console.log(postObj);
        fetch("/addtocart",{
          method: 'POST',
          credentials: 'same-origin',
          headers:{
              'Accept': 'application/json',
              'X-Requested-With': 'XMLHttpRequest',
              'X-CSRFToken': '{{ csrf_token }}',
          },
          body: JSON.stringify(postObj)
        }).then(response => {
	        return response.json();
        }).then(data => {
        	//console.log(data);
          alert(data['status']);
        });


      }else{
        alert("Please Enter The Quantity");
      }
    });

    btnFav.addEventListener("click", function() {



        let postObj = { 

            'pid': pid.value
        }
        //console.log(postObj);
        fetch("/fav",{
          method: 'POST',
          credentials: 'same-origin',
          headers:{
              'Accept': 'application/json',
              'X-Requested-With': 'XMLHttpRequest',
              'X-CSRFToken': '{{ csrf_token }}',
          },
          body: JSON.stringify(postObj)
        }).then(response => {
	        return response.json();
        }).then(data => {
        	//console.log(data);
          alert(data['status']);
        });



    });


  });
</script>

{% endblock content %}
 72 changes: 72 additions & 0 deletions72  
register.html
@@ -0,0 +1,72 @@
{% extends "shop/layouts/main.html" %}
{% block title %}
<title> Registration | EMart</title>
{% endblock title %}
{% block content %}

<div class="container" style="margin-top: 70px;">
    <div class="row">
        <div class="col-12">
        <h4 class="mb-3">Register</h4>
        <hr style="border-color: #b8bfc2;">
    {% include 'shop/inc/message.html' %}

    </div>
    </div>
    <section class="py-4 my-5">
        <div class="container">
            <div class="row">
                <div class="col-6">
                    <form method="post" action="">
                        {% csrf_token %}
                        <div class="mb-4">
                            <label for="" class="form-label">User Name</label>
                            {{form.username}}

                        </div>
                        <div class="mb-4">
                            <label for="" class="form-label">User Email</label>
                            {{form.email}}

                        </div>
                        <div class="mb-4">
                            <label for="" class="form-label">Password</label>
                            {{form.password1}}

                        </div>
                        <div class="mb-4">
                            <label for="" class="form-label">Confirm Password</label>
                            {{form.password2}}

                        </div>
                        <button type="submit" class="btn btn-primary">Register</button>
                    </form>
                    <p class="my-2">Already user ? <a href="{% url 'login' %}">Login Now</a></p>
                </div>
                <div class="col-6">

                        <div class="mb-4">

                            {% if form.errors.username %}
                            <label class="text-danger d-block">{{ form.errors.username }}</label>
                            {% endif %}

                            {% if form.errors.email %}
                            <label class="text-danger d-block">{{ form.errors.email }}</label>
                            {% endif %}

                            {% if form.errors.password1 %}
                            <label class="text-danger d-block">{{ form.errors.password1 }}</label>
                            {% endif %}

                            {% if form.errors.password2 %}
                            <label class="text-danger d-block">{{ form.errors.password2 }}</label>
                            {% endif %}

                </div>
            </div>
        </div>

    </section>
</div>
{% endblock content %}
 18 changes: 18 additions & 0 deletions18  
register.py
@@ -0,0 +1,18 @@
from django.http import JsonResponse
from django.shortcuts import render,redirect
from .models import *
from django.contrib import messages
from myapp.form import CustomUserForm
from django.contrib.auth import authenticate,login,logout
import json
from django.contrib.auth.decorators import login_required

def register(request):
    form=CustomUserForm()
    if request.method=='POST':
       form=CustomUserForm(request.POST)
       if form.is_valid():
          form.save()
          messages.success(request,"Registration Success You can Login Now..!")
          return redirect('/login')
    return render(request,"shop/register.html",{'form':form})
 137 changes: 137 additions & 0 deletions137  
settings.py
@@ -0,0 +1,137 @@
"""
Django settings for logi project.
Generated by 'django-admin startproject' using Django 4.2.
For more information on this file, see
https://docs.djangoproject.com/en/4.2/topics/settings/
For the full list of settings and their values, see
https://docs.djangoproject.com/en/4.2/ref/settings/
"""

from pathlib import Path

# Build paths inside the project like this: BASE_DIR / 'subdir'.
BASE_DIR = Path(__file__).resolve().parent.parent


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/4.2/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = 'django-insecure-f@lvdm1*(z5y38^c_@yc%m=2xivlvxidtz9q48pb4j&)74r2xt'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [
    'jazzmin',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'myapp',
]

MIDDLEWARE = [

    'django.middleware.security.SecurityMiddleware',
    'django.contrib.sessions.middleware.SessionMiddleware',
    'django.middleware.common.CommonMiddleware',
    'django.middleware.csrf.CsrfViewMiddleware',
    'django.contrib.auth.middleware.AuthenticationMiddleware',
    'django.contrib.messages.middleware.MessageMiddleware',
    'django.middleware.clickjacking.XFrameOptionsMiddleware',
]

ROOT_URLCONF = 'logi.urls'

TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [],
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

WSGI_APPLICATION = 'logi.wsgi.application'


# Database
# https://docs.djangoproject.com/en/4.2/ref/settings/#databases

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'emart',
        'USER' : 'root',
        'PASSWORD' : 'logi@12345',
        'HOST' : 'localhost',
        'PORT' : '3306',
    }
}


# Password validation
# https://docs.djangoproject.com/en/4.2/ref/settings/#auth-password-validators

AUTH_PASSWORD_VALIDATORS = [
    {
        'NAME': 'django.contrib.auth.password_validation.UserAttributeSimilarityValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.MinimumLengthValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.CommonPasswordValidator',
    },
    {
        'NAME': 'django.contrib.auth.password_validation.NumericPasswordValidator',
    },
]


# Internationalization
# https://docs.djangoproject.com/en/4.2/topics/i18n/

LANGUAGE_CODE = 'en-us'

TIME_ZONE = 'UTC'

USE_I18N = True

USE_TZ = True


# Static files (CSS, JavaScript, Images)
# https://docs.djangoproject.com/en/4.2/howto/static-files/

STATIC_URL = 'static/'

MEDIA_URL='/images/'
MEDIA_ROOT=BASE_DIR/'static'

STATICFILES_DIRS=[
    BASE_DIR/'static'
]

# Default primary key field type
# https://docs.djangoproject.com/en/4.2/ref/settings/#default-auto-field

DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
 31 changes: 31 additions & 0 deletions31  
slider.html
@@ -0,0 +1,31 @@
{% load static %}
<div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
    <div class="carousel-indicators">
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
      <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
    </div>
    <div class="carousel-inner">
      <div class="carousel-item active" style="height: 70vh;">
        <img src="{% static 'images/33.png' %}" class="d-block w-100" alt="slid-1">
      </div>
      <div class="carousel-item"  style="height: 70vh;">
        <img src="{% static 'images/22.png' %}" class="d-block w-100" alt="slid-2">
      </div>
      <div class="carousel-item"  style="height: 70vh;">
        <img src="{% static 'images/11.png' %}" class="d-block w-100" alt="slid-3">
      </div>
      <div class="carousel-item"  style="height: 70vh;">
        <img src="{% static 'images/44.png' %}" class="d-block w-100" alt="slid-4">
      </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>
 65 changes: 65 additions & 0 deletions65  
style.css
@@ -0,0 +1,65 @@
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:ital@1&display=swap');

html{
    font-size: 14px;
}
body{
    font-family: 'Noto Sans', sans-serif;
}
a{
    text-decoration: none;
}
a:link {
    text-decoration: none;
}

a:visited {
    text-decoration: none;
}

a:hover {
    text-decoration: none;
}

a:active {
    text-decoration: none;
}

.carousel-item img{
    object-fit: cover;
    object-position: top;
    height: 70vh;
    overflow: hidden;
}

.old_price{
    font-weight: bold;
    color: red;
}

.new_price{
    font-weight: bold;
    background-color: green;
    color: white;
    padding: 2px;
    border-radius: 5px;
}

.pic-box{
    position: relative;

}
.hot{
    background-color: orangered;
    color: white;
    width: 50px;
    text-align: center;
    font-weight: bold;
    display: inline;
    border-radius: 5px;
    padding: 5px;
    position: absolute;
    top: 0;
    right: 20px;
    z-index: 10;
}
 3 changes: 3 additions & 0 deletions3  
tests.py
@@ -0,0 +1,3 @@
from django.test import TestCase

# Create your tests here.
 27 changes: 27 additions & 0 deletions27  
urls.py
@@ -0,0 +1,27 @@
from django.urls import path
from myapp import views
from myapp import addcart
from myapp import register



urlpatterns= [
    path('',views.home,name="home"),
    path('register',register.register,name="register"),
    path('login',views.login_page,name="login"),
    path('collections',views.collections,name="collections"),
    path('collections/<str:name>',views.collectionsview,name="collections"),
    path('collections/<str:cname>/<str:pname>',views.product_details,name="product_details"),
    path('addtocart',addcart.add_to_cart,name="addtocart"),
    path('cart',views.cart_page,name="cart"),
    path('remove_cart/<str:cid>',views.remove_cart,name="remove_cart"),
    path('fav',views.fav_page,name="fav"),
    path('remove_fav/<str:fid>',views.remove_fav,name="remove_fav"),
    path('favviewpage',views.favviewpage,name="favviewpage"),
    path('signout',views.signout,name='signout'),
    path('checkout',views.checkout,name='checkout'),
    path('placeorder',views.placeorder,name='placeorder'),

    path('proceed-to-pay',views.razorpaycheck),

]
 224 changes: 224 additions & 0 deletions224  
views.py
@@ -0,0 +1,224 @@
from django.http import JsonResponse
from django.shortcuts import render,redirect
from .models import *
from django.contrib import messages
from myapp.form import CustomUserForm
from django.contrib.auth import authenticate,login,logout
import json
from django.contrib.auth.decorators import login_required
import random
# Create your views here.

def home(request):
    products=Product.objects.filter(trending=1)
    return render(request,"shop/index.html",{"products":products})

def cart_page(request):
  if request.user.is_authenticated:
    cart=Cart.objects.filter(user=request.user)
    return render(request,"shop/cart.html",{"cart":cart})
  else:
    return redirect("/")

def remove_cart(request,cid):
  cartitem=Cart.objects.get(id=cid)
  cartitem.delete()
  return redirect("/cart") 

def remove_fav(request,fid):
  item=Favourite.objects.get(id=fid)
  item.delete()
  return redirect("/favviewpage")  

def favviewpage(request):
  if request.user.is_authenticated:
    fav=Favourite.objects.filter(user=request.user)
    return render(request,"shop/fav.html",{"fav":fav})
  else:
    return redirect("/")

def fav_page(request):
   if request.headers.get('x-requested-with')=='XMLHttpRequest':
    if request.user.is_authenticated:
      data=json.load(request)
      product_id=data['pid']
      product_status=Product.objects.get(id=product_id)
      if product_status:
        if Favourite.objects.filter(user=request.user.id,product_id=product_id):
          return JsonResponse({'status':'Product Already in Favourite'}, status=200)
        else:
          Favourite.objects.create(user=request.user,product_id=product_id)
          return JsonResponse({'status':'Product Added to Favourite'}, status=200)


    else:
      return JsonResponse({'status':'Login to Add Favourite'}, status=200)
   else:
     return JsonResponse({'status':'Invalid Access'}, status=200)




def add_to_cart(request):
   if request.headers.get('x-requested-with')=='XMLHttpRequest':
    if request.user.is_authenticated:
      data=json.load(request)
      product_qty=data['product_qty']
      product_id=data['pid']
      product_status=Product.objects.get(id=product_id)
      if product_status:
        if Cart.objects.filter(user=request.user.id,product_id=product_id):
          return JsonResponse({'status':'Product Already in Cart'}, status=200)
        else:
          if product_status.quantity>=product_qty:
            Cart.objects.create(user=request.user,product_id=product_id,product_qty=product_qty)
            return JsonResponse({'status':'Product Added to Cart'}, status=200)
          else:
            return JsonResponse({'status':'Product Stock Not Available'}, status=200)
    else:
      return JsonResponse({'status':'Login to Add Cart'}, status=200)
   else:
     return JsonResponse({'status':'Invalid Access'}, status=200)



@login_required(login_url="/login/")
def placeorder(request):
  if request.method == 'POST':
    neworder=Order()
    neworder.user=request.user
    neworder.fname=request.POST.get('fname')
    neworder.lname=request.POST.get('lname')
    neworder.email=request.POST.get('email')
    neworder.phone=request.POST.get('phone')
    neworder.address=request.POST.get('address')
    neworder.city=request.POST.get('city')
    neworder.state=request.POST.get('state')
    neworder.country=request.POST.get('country')
    neworder.pincode=request.POST.get('pincode')

    neworder.payment_mode=request.POST.get('payment_mode')

    cart=Cart.objects.filter(user=request.user)
    cart_total_price = 0
    for item in cart:
      cart_total_price = cart_total_price + item.product.selling_price * item.product_qty

    neworder.total_price = cart_total_price
    trackno = 'sharma'+str(random.randint(1111111,9999999))
    while Order.objects.filter(tracking_no=trackno) is None:
      trackno = 'sharma'+str(random.randint(1111111,9999999))

    neworder.tracking_no= trackno
    neworder.save()

    neworderitems = Cart.objects.filter(user=request.user)
    for item in neworderitems:
      OrderItem.objects.create(
        order=neworder,
        product=item.product,
        price=item.product.selling_price,
        quantity=item.product_qty
      )

      # To decrease the product quantity from available stock
      orderproduct = Product.objects.filter(id=item.product_id).first()
      orderproduct.quantity=orderproduct.quantity - item.product_qty
      orderproduct.save()

    # To clear user's Cart
    Cart.objects.filter(user=request.user).delete()

    messages.success(request,"Your order has been placed successfully")


  return redirect('/')

def checkout(request):
  rawcart=Cart.objects.filter(user=request.user)
  for item in rawcart:
    if item.product_qty > item.product.quantity :
      Cart.objects.filter(user=request.user).delete()

      # Cart.objects.delete(id=item.id)

  cartitems = Cart.objects.filter(user=request.user)
  total_price = 0
  for item in cartitems:
    total_price = total_price + item.product.selling_price * item.product_qty    

  context={'cartitems':cartitems,'total_price':total_price}
  return render(request,"shop/checkout.html",context)

def login_page(request):
  if request.user.is_authenticated:
    return redirect("/")
  else:
    if request.method=='POST':
       name=request.POST.get('username')
       pwd=request.POST.get('password')
       user=authenticate(request,username=name,password=pwd)
       if user is not None:
          login(request,user)
          messages.success(request,"Logged in Successfully")
          return redirect("/")
       else:
          messages.error(request,"Invalid User Name or Password")
          return redirect("/login")   
    return render(request,"shop/login.html")


@login_required(login_url="/login/")
def signout(request):
    logout(request)
    messages.info(request, "Logged out successfully!")
    return redirect("/login")

def register(request):
    form=CustomUserForm()
    if request.method=='POST':
       form=CustomUserForm(request.POST)
       if form.is_valid():
          form.save()
          messages.success(request,"Registration Success You can Login Now..!")
          return redirect('/login')
    return render(request,"shop/register.html",{'form':form})

def collections(request):
    catagory=Catagory.objects.filter(status=0)
    return render(request,"shop/collections.html",{"catagory":catagory})

def collectionsview(request,name):
  if(Catagory.objects.filter(name=name,status=0)):
      products=Product.objects.filter(category__name=name)
      return render(request,"shop/products/index.html",{"products":products,"category_name":name})
  else:
    messages.warning(request,"No Such Catagory Found")
    return redirect('collections/')

def product_details(request,cname,pname):
  if(Catagory.objects.filter(name=cname,status=0)):
     if(Product.objects.filter(name=pname,status=0)):
        products=Product.objects.filter(name=pname,status=0).first()
        return render(request,"shop/products/product_details.html",{"products":products})
     else:
        messages.warning(request,"No Such Product Found")
        return redirect('collections')


  else:
    messages.warning(request,"No Such Catagory Found")
    return redirect('collections')


@login_required(login_url="/login/")
def razorpaycheck(request):
    cart =Cart.objects.filter(user=request.user)
    total_price =0
    for item in cart:
      total_price = total_price + item.product.selling_price*item.product_qty

    return JsonResponse({
      'total_price': total_price
    })

 16 changes: 16 additions & 0 deletions16  
wsgi.py
@@ -0,0 +1,16 @@
"""
WSGI config for logi project.
It exposes the WSGI callable as a module-level variable named ``application``.
For more information on this file, see
https://docs.djangoproject.com/en/4.2/howto/deployment/wsgi/
"""

import os

from django.core.wsgi import get_wsgi_application

os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'logi.settings')

application = get_wsgi_application()
0 comments on commit 574ce41
@logeshwarisathya
Comment
 
Leave a comment
 
Footer
 2024 GitHub, Inc.
Footer navigation
Terms
Privacy
Security
Status
Docs
Contact
Manage cookies
Do not share my personal information
Add files via upload  logeshwarisathya/Qspiders@574ce41
